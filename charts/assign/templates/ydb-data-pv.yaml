{{- if .Values.ydb.persistence.enabled }}
apiVersion: v1
kind: PersistentVolume
metadata:
  name: ydb-data

  annotations:
    assign.ukserp.ac.uk/component: "ydb"
    {{- with .Values.annotations }}
    {{- toYaml . | nindent 4 }}
    {{- end }}
    {{- with .Values.ydb.persistence.persistentVolume.annotations }}
    {{- toYaml . | nindent 4 }}
    {{- end }}

  labels:
    component: ydb
    app: {{ .Chart.Name }}
    release: {{ .Release.Name }}
    chart: {{ include "assign.labels.chart" . }}
    heritage: {{ .Release.Service }}
    {{- with .Values.labels }}
    {{- toYaml . | nindent 4 }}
    {{- end }}
    {{- with .Values.ydb.persistence.persistentVolume.labels }}
    {{- toYaml . | nindent 4 }}
    {{- end }}

spec:
  volumeMode: Filesystem

  persistentVolumeReclaimPolicy: {{ .Values.ydb.persistence.persistentVolumeReclaimPolicy }}
  storageClassName: {{ .Values.ydb.persistence.storageClassName }}

  capacity:
    storage: {{ .Values.ydb.persistence.capacity }}

  accessModes:
    - ReadWriteOnce
{{- end }}